<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />  
  <title>Login</title><link rel="stylesheet" href="asset/style.css">

</head>
<body>

		<div class="modal">
		  <h2>Login</h2>
		  <form id="loginForm">
			<div class="field"><label>Username : <input type="text" name="username" required></label></div>
			<div class="field"><label>Password : <input type="password" name="password" required></label></div>
			<button class="btn" type="submit" style="width:100%;">ðŸ”‘Login</button>
		  </form><br>
		  <button class="btn" onclick="window.location.href='register.html'" style="width:100%;">Registrasi</button>
		</div>
		
<script>
document.getElementById("loginForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const formData = new FormData(e.target);

  try {
    const response = await fetch("https://laporan.infinityfreeapp.com/api/auth.php", {
      method: "POST",
      body: formData,
    });

    // Ambil respon mentah untuk debugging
    const text = await response.text();
    console.log("Raw response:", text);

    let data;
    try {
      data = JSON.parse(text);
    } catch {
      alert("Respon bukan JSON:\n" + text);
      return;
    }

    if (data.status === "success") {
      alert("Login sukses! Role: " + data.role);
      if (data.role === "admin") {
        window.location.href = "dashboard_admin.html";
      } else {
        window.location.href = "dashboard_nasabah.html";
      }
    } else {
      alert(data.message || "Login gagal!");
    }
  } catch (error) {
    console.error("Fetch error:", error);
    alert("Gagal terhubung ke server.");
  }
});
</script>

</body>
</html>


